
## Запуск из colab
<a href='https://colab.research.google.com/drive/1k_VpJjBimHhkI16JlDJ1kCpJP3hE_zRK'>Ссылка на ноутбук</a>
# Применение ChatGPT для анализа и верификации данных анкетирования по модели EFQM

## Аннотация: 
в статье рассматриваются: вариант решения задачи оценки правдоподобности текста на примере оценки ответов работников кафедр на EFQM тестирование, применение предобученных ембедингов для нахождения похожих текстов и дообучение Chat-GPT используя динамическое конструирование промта.

Ключевые слова: искусственный интеллект, языковые модели, анализ текста, Chat-GPT.

## Введение
Трудно представить современный мир без нейронных сетей. Особенно большую пользу приносят крупные языковые модели, такие как Chat-GPT, YandexGPT, ruGPT (Сбер) и другие. Эти модели позволяют быстрее получать ответы на вопросы, суммировать информацию и решать различные повседневные задачи. Одной из важных задач в образовательных организациях является контроль качества работы сотрудников посредством тестирования или проведения интервью. Люди могут ошибаться при ответе на вопросы или намеренно предоставлять неверную информацию. Чтобы избежать подобных случаев, можно поручить одному из сотрудников проверку всех ответов и их сравнение с паспортами кафедр и другими нормативными документами. В среднем, поиск ответа на поставленный вопрос в паспорте кафедры занимает от 2 до 3 минут благодаря структурированности информации и способности человека абстрактно мыслить. Соответственно, на проверку всего анкетирования у человека уходит от 30 минут до 1,5 часов в зависимости от количества вопросов. При этом не исключены ошибки проверяющего из-за усталости. Это привело нас к необходимости решения задачи автоматизации с использованием искусственного интеллекта.

## Описание разработанной системы
Исходными данными для нашего исследования стали ответы на анкетирование и паспорта кафедр. 
Первый шаг включает преобразование файлов паспортов кафедр в набор фрагментов с последующей векторизацией с помощью предобученных эмбеддингов [1,3]. Поскольку нам неоднократно потребуется доступ к векторным представлениям этих текстов, а процесс их получения является медленным и ресурсоемким, было решено кешировать ранее рассчитанные вектора.
Исходными данными для нас стали: ответы на анкетирование и паспорта кафедр.

![image](https://github.com/Aleshka5/AI-TG-Assistant/assets/78702396/f8b9a2f8-68c2-4c56-bbae-94a557f713e2)

Рисунок 1. Алгоритм формирования векторного представления текстов

Вторым шагом является получение отдельных ответов на вопросы и их преобразование в вектора с использованием той же модели эмбеддинга. Эта процедура проводится для каждого ответа в анкетировании. Преобразование каждого запроса выполняется "на лету", поскольку модель эмбеддинга также кешируется в памяти, чтобы избежать её повторной загрузки при каждом обращении.

![image](https://github.com/Aleshka5/AI-TG-Assistant/assets/78702396/9966b8f0-c7d0-4d3f-84df-03338318f347)

Рисунок 2. Алгоритм преобразования ответа в вектор с помощью Embedding модели

Третьим шагом является нахождение трёх наиболее подходящих фрагментов из всех преобразованных. Наиболее надежным и простым инструментом для этой задачи является вычисление косинусного расстояния между вектором ответа и всеми векторами фрагментов кафедр. Чем меньше косинусное расстояние, тем лучше соответствие, поэтому мы сортируем расстояния до всех векторов по возрастанию и выбираем первые три. 

$$
Cosine Similarity = \frac{A \cdot B}{\|A\| \cdot \|B\|} = \frac{A \cdot B}{\sqrt{\sum_{i=1}^{n} (A_i)^2} \cdot \sqrt{\sum_{i=1}^{n} (B_i)^2}}
$$

,
где:

A – вектор ответа размера (1,1024),

B – вектор части текста кафедры размера (1,1024),

||A|| - модуль вектора A,

||B|| - модуль вектора B.

![image](https://github.com/Aleshka5/AI-TG-Assistant/assets/78702396/552a79dc-046b-4297-8074-cef8f0d49ae9)

Рисунок 3. Алгоритм поиска наиболее похожих на ответ текстов

На следующем этапе наиболее похожие тексты извлекаются из базы данных и вместе с текстом ответа подаются на оценку большой языковой модели. В учебных целях  использовали Chat-GPT [2], как наиболее мощную и доступную модель, однако также возможно  использовать другие языковые модели.

![image](https://github.com/Aleshka5/AI-TG-Assistant/assets/78702396/73b7c1ed-b50b-467d-b378-8ecfe0eccab9)

Рисунок 4. Схема использования API Chat-GPT

Нейросеть возвращает оценку правдоподобности текста от 1 до 10 и краткий комментарий к своему вердикту. Общая схема системы выглядит следующим образом:
Общая схема системы выглядит так:

![image](https://github.com/Aleshka5/AI-TG-Assistant/assets/78702396/f5d75178-77e9-49a5-a2bf-642a96616260)

Рисунок 5. Полная схема работы системы верификации данных

## Результаты
Далее приведены реальные примеры анализа анкетирования по системе EFQM с помощью данной системы. 

Ответ 1:

Всех сотрудников смущает ремонт помещений и оснащение лабораторий старым учебным и исследовательским оборудованием. Мы уже давно просим выделить инвестиции на учебно-исследовательский лабораторный комплекс. В который бы входили разные лаборатории.

Текст, выбранный из паспорта кафедры:

Учебные Лабораторная база кафедры. В рамках инновационной образовательной лаборатории программы и программы развития ФГБОУ ВО «НИУ «МЭИ» проведены ремонт помещений и оснащение лабораторий современным учебным и оборудованием. Кафедра располагает уникальным -исследовательским лабораторным комплексом в состав которого входят <…>.

Анализ от языковой модели:

На основании отрывка текста, который описывает современное оборудование и ремонт лабораторий на кафедре, утверждение о том, что всех сотрудников смущает старое оборудование и требуется новый учебно-исследовательский комплекс, кажется маловероятным.

Оценка правдоподобности: 2 из 10.

Комментарий: Из текста видно, что кафедра уже провела ремонт и оснастила лаборатории современным оборудованием. Утверждение о проблемах с устаревшим оборудованием не соответствует предоставленным данным и не выглядит правдоподобным.

Ответ 2:

Мы реализуем научно-исследовательские работы и проекты, которые достаточно актуальны. Кафедра активно участвует в научных проектах РФФИ. У нас есть целых 2 научные группы.

Текст, выбранный из паспорта кафедры:

НИОКР Научно-исследовательские работы и проекты, реализуемые на кафедре, отвечают актуальным проблемам электроэнергетики и электротехники. Кафедра активно участвует в реализации фундаментальных НИОКТР в рамках научных проектов РФФИ. Научные группы 

Анализ от языковой модели:

Оценка: 7 из 10.
Комментарий: Утверждение кажется вполне правдоподобным, учитывая актуальность работ и участие в фундаментальных проектах. Однако не хватает информации для подтверждения количества научных групп.

Ответ 3: 

Наша кафедра имеет уникальное оборудование. Например: комплекс для исследования характеристик магнитных и сверхпроводящих материалов, исследовательская лаборатория электромагнитного поля, дающая возможность фронтального проведения лабораторных работ и супер компьютер для обучения больших языковых моделей.

Текст, выбранный из паспорта кафедры:

Лабораторная база Кафедра имеет уникальное оборудование: 

Учебно-исследовательская лаборатория электромагнитного поля, единственная в университетах Европы, дающая возможность фронтального проведения лабораторных работ; 

Приборный комплекс для исследования характеристик магнитных и сверхпроводящих материалов;

Приборный комплекс для исследования характеристик четырехполюсников, поглощающих материалов и диэлектриков в диапазоне частот от 0 до 40 ГГц.

Анализ от языковой модели:

Оценка: 4/10
Комментарий: Утверждение содержит частично согласующуюся информацию с представленными отрывками текста. Хотя утверждение упоминает комплекс для исследования характеристик магнитных и сверхпроводящих материалов, что соответствует информации из первого текста, другие детали, такие как исследовательская лаборатория электромагнитного поля и суперкомпьютер для обучения языковых моделей, не упоминаются в предоставленных отрывках. Это снижает общую правдоподобность утверждения.

Ответ 4:

Я помню лишь не многие индикаторы выполнения: Минимальный показатель эффективности ППС - около 15 в среднем. Среднее значение показателя эффективности - около 50. А минимальный показатель эффективности и среднее значение показателя эффективности НС кафедры уже не помню.

Текст, выбранный из паспорта кафедры:

| Индикаторы выполнения по разделу            | 2019 | 2020 | 2021 | 2022 | 2023 | 2024 | 2025 |
|---------------------------------------------|------|------|------|------|------|------|------|
| Минимальный показатель эффективности ППС кафедры | 19   | 12   | 15   | 17   | 18   | 20   |      |
| Среднее значение показателя эффективности    | 45   | 50   | 55   | 60   | 62   | 60   |      |

Анализ от языковой модели:

Утверждение предполагает, что минимальный показатель эффективности ППС и среднее значение показателя эффективности научно-исследовательской кафедры (НС кафедры) примерно равны 15 и 50 соответственно.

Из предоставленных данных видно, что:

Минимальный показатель эффективности ППС в период с 2019 по 2024 годы составлял: 12, 15, 17, 18, 20.

Среднее значение показателя эффективности НС кафедры в тот же период составляло: 45, 50, 55, 60, 62.

Таким образом, утверждение не соответствует данным из текста. Оценка правдоподобности утверждения будет низкой. Предполагаемые значения не совпадают с предоставленной информацией.

Оценка: 2 из 10.


Последний пример показывает, что модель способна подсчитывать средние показатели и сравнивать их с утверждениями из ответа. Так же можно заметить, что модель может как утверждать, что ответ верный, так и то, что найдены несостыковки. А также она может заметить небольшое отклонение в, казалось бы, верном утверждении, где человек мог бы просто не обратить на это внимание.
## Заключение
Данная система имеет суммарное время выполнения для одного полного анкетирования около 3-10 минут в зависимости от количества вопросов при достаточно высокой точности обнаружения нужных тем и выдаче ответов на уровне человека. Это на порядок быстрее и дешевле, чем работа человека. Затраты включают оплату работы с Chat-GPT, что составляет около 0.001$ за запрос, и аренду сервера для работы бота и хранения базы данных (~350-500 рублей в месяц).
Человеческая помощь может потребоваться в случаях, когда Chat-GPT указывает на недостаточность информации для вынесения вердикта, что значительно экономит человеческие ресурсы.
